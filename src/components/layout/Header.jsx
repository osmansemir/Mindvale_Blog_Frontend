import { useState } from "react";
import { ModeToggle } from "../ModeToggle";
import { Link, useNavigate } from "react-router-dom";
import { useAuth } from "../../hooks/useAuth";
import RoleGuard from "../auth/RoleGuard";
import { Button } from "../ui/button";
import {
  User,
  LogOut,
  Shield,
  FileText,
  Users,
  Menu,
  Home,
  PenSquare,
} from "lucide-react";
import UpgradeToAuthorButton from "../user/UpgradeToAuthorButton";
import { Separator } from "../ui/separator";
import UserDropdown from "./UserDropDown";
import { PencilLine } from "lucide-react";
import { Earth } from "lucide-react";

function Header() {
  const { user, isAuthenticated, logout } = useAuth();
  const navigate = useNavigate();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

  const handleLogout = () => {
    logout();
    navigate("/sign-in");
    setMobileMenuOpen(false);
  };

  // const closeMobileMenu = () => {
  //   setMobileMenuOpen(false);
  // };

  return (
    <div className="flex items-center px-14 sticky top-0 z-10 h-24 w-full bg-background/80 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border">
      <div className="flex gap-4  justify-between items-center w-full ">
        <div className=" flex gap-4">
          <Link className="flex justify-center items-center gap-2" to="/">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              id="svg1"
              width="24"
              height="24"
              version="1.1"
              viewBox="0 0 306.885 302.717"
            >
              <g id="g1" transform="translate(-336.82 -334.647)">
                <path
                  id="rect1"
                  fill="currentColor"
                  fillOpacity="1"
                  d="M519.787 334.647c-6.385.019-10.62 2.347-15.967 8.422-5.978 6.792-7.115 11.685-7.115 30.577 0 17.58-.33 16.904 7 14.318 2.338-.825 5.783-1.5 7.656-1.5 3.789 0 3.68.202 5.154-9.397 2.205-14.344 10.169-24.872 23.953-31.658 3.53-1.738 6.042-3.533 5.578-3.988-1.766-1.737-17.127-6.102-23.382-6.645a32 32 0 0 0-2.877-.129m-60.018.454c-7.289.13-23.053 3.951-25.215 6.113-.552.552 1.968 2.343 6.367 4.521 8.988 4.45 17.227 12.311 20.674 19.729 2.05 4.412 2.66 7.577 3.082 16 .29 5.775.891 11.062 1.336 11.75.445.687 2.245 1.263 4 1.277s4.992.877 7.192 1.918 4.562 1.93 5.25 1.975c.962.062 1.248-4.69 1.244-20.67-.003-11.413-.448-22.34-.989-24.283-1.563-5.628-6.542-12.63-11.138-15.666-3.772-2.492-5.072-2.785-11.803-2.664m99.787 17.095c-5.97.19-12.272 1.447-16.728 3.705-5.893 2.987-10.597 8.2-14.002 15.518-2.529 5.433-2.577 5.938-2.338 24.977.205 16.343.52 19.903 1.98 22.396 2.807 4.791 6.121 6.534 14.305 7.522 12.042 1.452 19.302 6.016 23.422 14.724 1.558 3.295 3.129 5.377 3.826 5.072.65-.284 5.009-2.178 9.684-4.207s9.12-4.268 9.878-4.978c1.951-1.826.84-5.209-3.57-10.87-3.362-4.314-3.799-5.552-4.15-11.77l-.393-6.948-5.187-2.295c-2.853-1.262-6.798-3.707-8.766-5.436-1.968-1.728-4.193-3.143-4.945-3.146-4.312-.018-9.115-2.353-10.916-5.307-2.752-4.512-2.462-8.085.967-11.922 2.558-2.862 3.504-3.253 7.67-3.166 4.009.085 5.195.596 7.582 3.266 1.748 1.956 2.83 4.291 2.83 6.111 0 3.424 2.572 6.155 8.507 9.028 5.41 2.618 7.522 2.52 13.756-.639 3.654-1.851 7.132-2.728 11.701-2.95 3.576-.172 6.636-.72 6.801-1.216.864-2.591-25.534-27.28-37.168-34.762-3.136-2.017-8.775-2.896-14.746-2.707m-137.271.284c-5.634-.274-11.083.19-13.672 1.523-3.757 1.932-12.522 8.39-20.713 15.26-5.799 4.863-19.195 19.64-19.195 21.172 0 .526 2.979.934 6.62.906 5.543-.043 7.66.474 12.985 3.178l6.363 3.23 4.543-1.736c5.886-2.248 11.489-7.505 11.489-10.782 0-3.443 3.362-7.401 7.43-8.744 4.055-1.338 9.736.554 11.488 3.827 3.371 6.3-.737 14.387-7.891 15.53-2.372.38-6.104 2.222-9.117 4.503-2.805 2.123-6.81 4.425-8.9 5.115l-3.8 1.254-.38 6.734c-.31 5.48-.935 7.531-3.356 11-8.26 11.836-8.218 12.66.785 15.889 3.432 1.23 7.816 3.094 9.74 4.14 1.926 1.047 4.008 1.92 4.631 1.944.623.023 2.323-2.387 3.776-5.358 4.125-8.431 11.162-12.98 22.594-14.601 15.583-2.21 16.5-3.905 16.5-30.5 0-19.49-.069-20.142-2.622-25.586-3.198-6.82-8.076-11.857-14.521-14.994-3.326-1.62-9.144-2.631-14.777-2.904m89.578 44.996c-3.59-.1-7.887 1.651-11.219 4.662l-3.94 3.56v14.672c0 17.22 1.445 24.243 6.506 31.596 3.982 5.784 8.518 9.123 15.815 11.644 6.763 2.338 12.019 2.303 19.896-.13 3.535-1.092 9.206-3.783 12.604-5.979 6.978-4.51 7.766-6.919 4.183-12.795-2.834-4.649-7.35-7.013-14.917-7.81-3.624-.382-7.711-1.112-9.086-1.62-4.835-1.786-10.154-6.217-12.721-10.597-2.224-3.794-2.68-6.014-3.188-15.559-.52-9.773-.82-11.176-2.443-11.486a9.3 9.3 0 0 0-1.49-.158m94.648 3.988c-8.392 0-13.806 4.606-13.806 11.742 0 2.894.963 5.096 4 9.137 2.2 2.928 4.005 6.29 4.013 7.472.03 4.176 1.036 4.528 13.008 4.561 6.313.017 13.054.447 14.979.957s4.541.973 5.816 1.03c1.95.085 2.211-.256 1.648-2.15-1.651-5.556-9.005-21.237-11.162-23.8-3.288-3.907-13.707-8.95-18.496-8.95m-230.65.383c-8.528-.367-18.862 5.127-22.662 12.627-6.285 12.403-10.281 24.108-8.186 23.978.105-.007 2.667-.676 5.692-1.488 3.33-.894 10.051-1.48 17.04-1.486l11.544-.014 1.218-4.555c.67-2.506 2.788-6.887 4.707-9.736 2.172-3.225 3.49-6.384 3.49-8.367 0-4.415-4.121-9.026-9.324-10.432a16 16 0 0 0-3.52-.527m93.271 3.617c-2.76 0-3.26.411-3.802 3.125-.344 1.719-.63 4.531-.635 6.25-.013 4.13-4.018 12.45-7.615 15.822-3.896 3.653-8.716 5.52-16.42 6.363-3.552.39-7.67 1.322-9.155 2.073-3.501 1.772-7.62 7.215-8.396 11.095-.584 2.92-.295 3.25 6.328 7.184 10.755 6.39 16.543 8.201 24.834 7.775 5.415-.278 8.29-1.029 12.303-3.212 9.995-5.44 15.602-13.93 17.123-25.926.995-7.848.367-19.813-1.201-22.866-1.477-2.873-9.843-7.683-13.364-7.683m148.836 42.23c-6.544-.23-13.327.132-18.17 1.159-9.011 1.91-14.844 4.59-40.593 18.642-16.74 9.136-36.09 18.544-43.815 21.307-3.327 1.19-.739 2.508 9.08 4.625 35.522 7.657 46.09 10.996 53.76 16.99 2.735 2.137 5.272 3.922 5.635 3.967s2.843-1.645 5.513-3.756 8.743-8.004 13.495-13.096c13.3-14.253 21.088-19.564 33.533-22.861l6.799-1.8-.247-7.806c-.33-10.583-1.475-12.66-8.257-14.988-3.883-1.333-10.188-2.153-16.733-2.383m-253.43 1.282q-2.987.1-5.87.494c-10.424 1.427-17.718 3.664-18.846 5.78-1.27 2.38-3.357 19.853-2.951 24.704l.334 3.988 8.21 1.698c14.23 2.94 20.174 6.38 36.633 21.19 16.973 15.27 23.058 19.01 38.2 23.482 11.721 3.462 16.477 4.066 29.457 3.742 9.294-.232 15.32-.998 23.5-2.983 12.541-3.043 25-9.065 25-12.086 0-1.377-2.479-2.857-10-5.966-16.036-6.63-29.134-14.712-51.118-31.547-11.323-8.672-23.977-17.706-28.119-20.076-15.017-8.592-30.495-12.89-44.43-12.42m130.653 34.552c-2.241.093-5.453.588-9.328 1.47-8.032 1.826-13.158 4.696-13.158 7.364 0 3.989 5.727 6.95 26.406 13.657 22.198 7.2 26.22 9.112 27.176 12.921 1.958 7.805-8.523 12.49-52.582 23.5-23.363 5.839-47.291 13.592-58.762 19.04-20.998 9.971-29.238 18.468-29.238 30.148 0 3.238.622 4.618 3.16 6.988 18.143 16.949 49.954 32.595 75.84 37.305 9.16 1.666 41.86 1.975 50.468.476 5.993-1.043 9.446-2.373 8.502-3.273-.259-.247-6.823-1.61-14.586-3.03-16.929-3.096-35.732-8.636-43.68-12.868-21.078-11.226-24.478-26.63-9.001-40.774 9.193-8.402 26.065-15.54 56.797-24.033 22.501-6.219 33.13-9.761 42.15-14.045 19.797-9.402 22.328-18.772 7.158-26.494-5.957-3.033-14.238-5.277-39.867-10.799-22.454-4.838-27.223-6.405-28.871-9.484-.891-1.665-.69-2.41 1.107-4.084 1.21-1.127 2.564-2.047 3.01-2.047s.813-.45.813-1c0-.721-1.273-1.03-3.514-.938m-155.566 10.905c-1.156.033-1.958.283-2.272.79-.976 1.58 4.399 28.22 7.424 36.79 2.917 8.263 12.825 29.31 15.162 32.203 1.432 1.773 2.123 1.613 7.373-1.717 8.245-5.229 26.057-12.066 41.305-15.853 8.152-2.025 14.904-4.094 15.004-4.6s-3.103-1.884-7.118-3.063c-13.66-4.01-25.42-11.301-39.056-24.214-4.817-4.562-11.166-9.893-14.108-11.846-7.08-4.7-18.706-8.633-23.714-8.49m303.214 3.154c-1.107-.028-3.292 2.119-6.634 6.49-5.741 7.51-20.433 21.91-29.362 28.781-6.675 5.137-15.4 10.302-21.638 12.811-2.2.885-6.545 3.148-9.655 5.03-5.668 3.429-15.043 6.81-42.574 15.35-33.886 10.514-45.271 17.499-45.271 27.78 0 4.746 5.185 10.61 11.962 13.526 10.647 4.58 38.025 9.826 52.038 9.972l6.5.069-11-5.297c-16.578-7.98-20.834-12.563-17.975-19.362 3.41-8.108 23.138-13.844 66.475-19.332 9.625-1.218 18.501-2.589 19.726-3.045 4.083-1.518 17.223-25.537 21.6-39.484 2.497-7.957 6.674-27.644 6.674-31.46 0-1.202-.285-1.814-.866-1.829"
                ></path>
              </g>
            </svg>
            <span className="inline-block text-md">Mindvale</span>
          </Link>
        </div>
        <div className="flex items-center gap-4 justify-self-end">
          <RoleGuard allowedRoles={["author", "admin"]}>
            <Link className="" to="/articles/new">
              <Button className="font-bold">
                <PencilLine />
                Write
              </Button>
            </Link>
          </RoleGuard>
          <ModeToggle />
          {!isAuthenticated ? (
            <div className="flex items-center gap-2">
              <Button asChild variant="ghost" size="sm">
                <Link to="/sign-in">Sign In</Link>
              </Button>
              <Button asChild variant="default" size="sm">
                <Link to="/sign-up">Sign Up</Link>
              </Button>
            </div>
          ) : (
            <UserDropdown />
          )}
        </div>
      </div>
    </div>
  );
}

export default Header;
